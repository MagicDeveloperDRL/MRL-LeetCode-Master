# 【目录】回溯算法

回溯法也可以叫做回溯搜索法，它是一种搜索的方式。

回溯是递归的副产品，只要有递归就会有回溯。

**因为回溯的本质是穷举，穷举所有可能，然后选出我们想要的答案**，如果想让回溯法高效一些，可以加一些剪枝的操作，但也改不了回溯法就是穷举的本质。

回溯法，一般可以解决如下几种问题：

- 组合问题：N个数里面按一定规则找出k个数的集合

- 切割问题：一个字符串按一定规则有几种切割方式

- 子集问题：一个N个数的集合里有多少符合条件的子集

- 排列问题：N个数按一定规则全排列，有几种排列方式

- 棋盘问题：N皇后，解数独等等

  **回溯法解决的问题都可以抽象为树形结构**，是的，我指的是所有回溯法的问题都可以抽象为树形结构！

  因为回溯法解决的都是在集合中递归查找子集，**集合的大小就构成了树的宽度，递归的深度，都构成的树的深度**。

  递归就要有终止条件，所以必然是一颗高度有限的树（N叉树）。

[TOC]

```c++
vector<vector<int>> result; // 存放符合条件结果的集合
vector<int> path; // 用来存放符合条件结果
// 回溯函数
void backtracking(int n, int k, int startIndex) {
    // 终止条件
    if (path.size() == k) {
        result.push_back(path);
        return;//不可以漏掉
    }
    // 循环进行横向遍历,决定了树层集合如何变化，即所有的组合中是否存在重复
    for (int i = startIndex; i <= n ; i++) {
        // 处理节点
        path.push_back(i);
        // 纵向递归
        backtracking(n, k, i); //递归进行纵向遍历，决定了树枝集合如何变化，决定了每个组合内容是否存在重复
        // 回溯撤销
        path.pop_back(); 
    }
}
```



## 待取元素集合的特征：

是否只有一个

内部元素是否可重复

每个元素在每个组合内是否只可使用一次

个数是否可变

## 每个组合的特征：

组合之间无重复

组合内部可重复

组合之和必须为target



剪枝操作是提前去除一些不合理的可能，并不会影响结果，但是会影响效率

剪枝操作：

如果组合的个数必须为k，则i<n - (k - path.size())+1时可剪枝

如果组合的和必须为n，则sum>n时可剪枝

### 1、组合问题

[01回溯算法的组合问题](./01回溯算法的组合问题.md)

N个数里面按一定规则找出k个数的集合（不强调元素的顺序）

| **LeetCode题目** | **相关题目类型**               | 题目类型分析                                                 | 题目思路                                                     | **相关链接**                                                 |
| ---------------- | ------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 77               | 组合（中等难度）               | 【待取元素集合】：取同一个；元素无重复；个数恒为n；每个元素在每个组合内只可使用一次【可能的组合】：组合内部大小必须为k；组合内部无重复，组合之间无重复； | “组合内部无重复，组合之间无重复”说明所有的横向循环和纵向循环要不断变化；“组合必须为k个数”说明了终止条件 | https://leetcode-cn.com/problems/combinations/               |
| 216              | 组合总和III（中等难度）        | 【待取元素集合】：取同一个；元素无重复；个数恒为9；每个元素在每个组合内只可使用一次【可能的组合】：组合内部大小必须为k，组合之和必须为n；组合内部无重复，组合之间无重复； | “组合内部无重复，组合之间无重复”说明所有的横向循环和纵向循环要不断变化；“组合必须为k个数，组合之和必须为n”说明了终止条件 | https://leetcode-cn.com/problems/combination-sum-iii/        |
| 17               | 电话号码的字母组合（中等难度） | 【待取元素集合】：取不同个，个数输入决定；元素无重复；个数恒为3；每个元素在每个组合内只可使用一次【可能的组合】：组合内部大小不确定，由待取元素集合的个数决定；组合内部无重复，组合之间无重复； | 从不同的【待取元素集合】中取数                               | https://leetcode-cn.com/problems/letter-combinations-of-a-phone-number/ |
| 39               | 组合总和（中等难度）           | 【待取元素集合】：取同一个；元素无重复；个数变化；每个元素在每个组合内可使用多次【可能的组合】：组合之和必须为target；组合内部可重复，组合之间无重复； | “每个元素在每个组合内可使用多次“说明纵向循环不变化；“组合之间无重复“说明横向循环要变化； | https://leetcode-cn.com/problems/combination-sum/            |
| 40               | 组合总和II（中等难度）         | 【待取元素集合】：取同一个；元素可重复；个数变化；每个元素在每个组合内只可使用一次【可能的组合】：组合之和必须为target；组合内部可重复，组合之间无重复； | “元素可重复“说明要先对每个元素进行怕徐，每个元素在每个组合内只可使用一次“说明纵向循环不变化；“组合之间无重复“说明横向循环要变化； | https://leetcode-cn.com/problems/combination-sum-ii/         |

### 2、子集问题

[03回溯算法的子集问题](./03回溯算法的子集问题.md)

一个N个数的集合里有多少符合条件的子集

| **LeetCode题目** | **相关题目类型**   | 关键点                                                       | **相关链接**                                 |
| ---------------- | ------------------ | ------------------------------------------------------------ | -------------------------------------------- |
| 78               | 子集（中等难度）   | **遍历这个树的时候，把所有节点都记录下来，就是要求的子集集合**。 | https://leetcode-cn.com/problems/subsets/    |
| 90               | 子集II（中等难度） | 树层去重                                                     | https://leetcode-cn.com/problems/subsets-ii/ |

### 3、排列问题

[04回溯算法的排列问题](./04回溯算法的排列问题.md)

N个数按一定规则全排列，有几种排列方式

| **LeetCode题目** | **相关题目类型**     | 关键点 | **相关链接**                                      |
| ---------------- | -------------------- | ------ | ------------------------------------------------- |
| 46               | 全排列（中等难度）   |        | https://leetcode-cn.com/problems/permutations/    |
| 47               | 全排列II（简单难度） |        | https://leetcode-cn.com/problems/permutations-ii/ |

### 4、其他问题

[06回溯算法的其他问题](./06回溯算法的其他问题.md)

| **LeetCode题目** | **相关题目类型**         | 关键点 | **相关链接**                                              |
| ---------------- | ------------------------ | ------ | --------------------------------------------------------- |
| 491              | 递增子序列（中等难度）   |        | https://leetcode-cn.com/problems/increasing-subsequences/ |
| 332              | 重新安排行程（中等难度） |        | https://leetcode-cn.com/problems/reconstruct-itinerary/   |

### 5、分割问题

[02回溯算法的分割问题](./02回溯算法的分割问题.md)

一个字符串按一定规则有几种切割方式

| **LeetCode题目** | **相关题目类型**       | 关键点                               | 题目思路 | **相关链接**                                              |
| ---------------- | ---------------------- | ------------------------------------ | -------- | --------------------------------------------------------- |
| 131              | 分割回文串（中等难度） | 求字符串的子串；判断是否是回文字符串 |          | https://leetcode-cn.com/problems/palindrome-partitioning/ |
| 93               | 复原IP地址（中等难度） | 较为繁琐与复杂，需要多练习           |          | https://leetcode-cn.com/problems/restore-ip-addresses/    |

### 6、棋盘问题

[05回溯算法的棋盘问题](./05回溯算法的棋盘问题.md)

N皇后，解数独等等

| **LeetCode题目** | **相关题目类型**   | 关键点 | **相关链接**                                    |
| ---------------- | ------------------ | ------ | ----------------------------------------------- |
| 51               | N皇后（困难难度）  |        | https://leetcode-cn.com/problems/n-queens/      |
| 37               | 解数独（困难难度） |        | https://leetcode-cn.com/problems/sudoku-solver/ |



